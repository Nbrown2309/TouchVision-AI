<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Analysis Results</title>

  <!-- Tailwind CDN (same as main page) -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body class="min-h-screen bg-gradient-to-br from-gray-900 via-gray-800 to-black text-white">

  <!-- Page Wrapper -->
  <div class="max-w-6xl mx-auto px-6 py-10">

    <!-- Header -->
    <div class="text-center mb-10">
      <h1 class="text-4xl font-bold tracking-tight">
        Analysis Results
      </h1>
      <p class="text-gray-400 mt-2">
        AI-powered Touch Rugby performance insights
      </p>
    </div>

    <!-- Error Message -->
    {% if error %}
      <div class="bg-red-500/10 border border-red-500/30 text-red-400 p-4 rounded-xl text-center mb-8">
        {{ error }}
      </div>
    {% endif %}

    {% if result %}

      <!-- Video Card -->
      <div class="bg-white/5 border border-white/10 rounded-2xl p-6 shadow-xl mb-10">
        <h2 class="text-xl font-semibold mb-4 text-center">
          Match Footage
        </h2>

        <video controls class="w-full rounded-xl">
          <source src="/data/uploads/{{ result.filename }}" type="video/mp4">
        </video>
      </div>

      <!-- Performance Charts -->
      <div class="bg-white/5 border border-white/10 rounded-2xl p-6 shadow-xl">
        <h2 class="text-xl font-semibold text-center mb-6">
          Performance Analytics
        </h2>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div class="bg-black/30 p-4 rounded-xl">
            <canvas id="playerMovementsChart"></canvas>
          </div>

          <div class="bg-black/30 p-4 rounded-xl">
            <canvas id="tacticsChart"></canvas>
          </div>
        </div>
      </div>

      <!-- Charts Script -->
      <script>
        const playerMovements = {{ result.player_movements | tojson }};
        const tactics = {{ result.tactics | tojson }};

        new Chart(document.getElementById("playerMovementsChart"), {
          type: "line",
          data: {
            labels: playerMovements.map((_, i) => i + 1),
            datasets: [{
              label: "Player Movement Intensity",
              data: playerMovements,
              tension: 0.4
            }]
          },
          options: {
            responsive: true,
            plugins: {
              legend: { labels: { color: "white" } }
            },
            scales: {
              x: { ticks: { color: "white" } },
              y: { ticks: { color: "white" } }
            }
          }
        });

        new Chart(document.getElementById("tacticsChart"), {
          type: "bar",
          data: {
            labels: tactics.map((_, i) => "Phase " + (i + 1)),
            datasets: [{
              label: "Tactical Events",
              data: tactics
            }]
          },
          options: {
            responsive: true,
            plugins: {
              legend: { labels: { color: "white" } }
            },
            scales: {
              x: { ticks: { color: "white" } },
              y: { ticks: { color: "white" } }
            }
          }
        });
      </script>

    {% endif %}

  </div>

</body>
</html>
