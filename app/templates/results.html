{% extends "base.html" %}

{% block title %}Analysis Results | TouchVision-AI{% endblock %}

{% block content %}
<div class="max-w-6xl mx-auto">

  <div class="text-center mb-10">
    <h2 class="text-4xl font-bold mb-2">Analysis Results</h2>
    <p class="text-blue-200">
      AI-powered Touch Rugby performance insights
    </p>
  </div>

  {% if error %}
    <div class="bg-red-500/20 border border-red-400/30 p-4 rounded-xl text-center text-red-300 mb-8">
      {{ error }}
    </div>
  {% endif %}

  {% if result %}

    <!-- Video Preview -->
    <div class="bg-white/10 border border-white/20 rounded-2xl p-6 shadow-xl mb-10">
      <h3 class="text-xl font-semibold mb-4 text-center">Match Footage</h3>
      <video controls class="w-full rounded-xl">
        <source src="/data/uploads/{{ result.filename }}" type="video/mp4">
      </video>
    </div>

    <!-- Performance Charts -->
    <div class="bg-white/10 border border-white/20 rounded-2xl p-6 shadow-xl">
      <h3 class="text-2xl font-semibold text-center mb-6">Performance Analytics</h3>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div class="bg-black/30 p-4 rounded-xl">
          <canvas id="playerMovementsChart"></canvas>
        </div>

        <div class="bg-black/30 p-4 rounded-xl">
          <canvas id="tacticsChart"></canvas>
        </div>
      </div>
    </div>

    <script>
      const playerMovements = {{ result.player_movements | tojson }};
      const tactics = {{ result.tactics | tojson }};

      new Chart(document.getElementById("playerMovementsChart"), {
        type: "line",
        data: {
          labels: playerMovements.map((_, i) => i + 1),
          datasets: [{
            label: "Player Movement Intensity",
            data: playerMovements,
            tension: 0.4
          }]
        }
      });

      new Chart(document.getElementById("tacticsChart"), {
        type: "bar",
        data: {
          labels: tactics.map((_, i) => "Phase " + (i + 1)),
          datasets: [{
            label: "Tactical Events",
            data: tactics
          }]
        }
      });
    </script>

  {% endif %}
</div>
{% endblock %}
